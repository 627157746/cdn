(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{564:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return n}));var o=function(e){return e.$get("/videos",{progress:!1})},n=function(e,data){return e.$post("/videos/score",data,{progress:!1})}},566:function(e,t,r){},574:function(e,t,r){"use strict";var o=r(566);r.n(o).a},581:function(e,t,r){"use strict";r.r(t);r(27),r(31),r(85);var o=r(25),video=r(564),n={middleware:"video-client",layout:"video",asyncData:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$axios,t.next=3,Object(video.a)(r);case 3:return o=t.sent,data=o.data,t.abrupt("return",{videos:data});case 6:case"end":return t.stop()}}),t)})))()},data:function(){var e=this;return{videos:[],isQQMobile:!1,video:null,current:0,error:!1,show:!1,loading:!1,iconPlayShow:!1,likeList:[],dislikeList:[],touch:{up:function(){return e.changeVideo("up")},down:function(){return e.changeVideo("down")}}}},computed:{disableLike:function(){return function(e){return this.likeList.includes(e)}},disableDislike:function(){return function(e){return this.dislikeList.includes(e)}}},destroyed:function(){this.video.pause(),this.video.src=""},mounted:function(){this.playVideo()},methods:{playVideo:function(){var e=this;this.isQQMobile=navigator.userAgent.toLowerCase().includes("mqqbrowser"),this.video=this.$refs.video,setTimeout((function(){e.video.play(),e.video.paused&&(e.iconPlayShow=!0)}),100),"1"!==localStorage.getItem("tip")&&(this.$toast.show("上滑加载下一条视频，下滑加载上一条视频",{position:"bottom-center",duration:3e3}),localStorage.setItem("tip","1"))},changeVideo:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.show=!1,t.error=!1,setTimeout((function(){t.video.pause(),t.iconPlayShow=!1,"down"===e?t.current>0&&(t.current-=1):t.current+=1,t.video.src=t.videos[t.current],t.video.play(),t.video.paused&&(t.iconPlayShow=!0)}),500),!(t.videos.length-t.current<=3)){r.next=9;break}return r.next=6,Object(video.a)(t.$axios);case 6:o=r.sent,o.data.forEach((function(e){t.videos.push(e)}));case 9:case"end":return r.stop()}}),r)})))()},pauseVideo:function(){var e=this;this.video.paused?setTimeout((function(){e.iconPlayShow=!1,e.video.play()}),100):setTimeout((function(){e.iconPlayShow=!0,e.video.pause()}),100)},videoLoadError:function(){this.error=!0},canPlay:function(){this.loading=!1,this.show=!0},waiting:function(){this.loading=!0},like:function(e){this.likeList.push(e);var data={url:e,type:1};Object(video.b)(this.$axios,data)},dislike:function(e){this.dislikeList.push(e);var data={url:e,type:2};Object(video.b)(this.$axios,data)}},head:function(){return{title:"短视频"}}},c=(r(574),r(44)),l=r(52),d=r.n(l),v=r(215),h=r(529),f=r(199),w=r(198),m=r(205),y=r(121),k=r(43),x=r(530),V=r.n(x),C=r(130),component=Object(c.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",{directives:[{name:"touch",rawName:"v-touch",value:e.touch,expression:"touch"}],staticClass:"video-box",attrs:{color:"black"}},[r("v-toolbar",{directives:[{name:"show",rawName:"v-show",value:e.iconPlayShow,expression:"iconPlayShow"}],staticClass:"bar",attrs:{dense:"",color:"transparent"}},[r("v-btn",{attrs:{nuxt:"",link:"",to:"/",icon:""}},[r("v-icon",{attrs:{large:"",color:"pink"}},[e._v("\n        mdi-home\n      ")])],1)],1),e._v(" "),e.videos?[r("transition",{attrs:{name:"fade"}},[r("video",{directives:[{name:"show",rawName:"v-show",value:e.show&&!e.error||e.isQQMobile,expression:"(show&&!error)|| isQQMobile"}],ref:"video",staticClass:"video",attrs:{"webkit-playsinline":"true",playsinline:"true","x5-video-player-type":"h5","x5-video-player-fullscreen":"true",preload:"",loop:"",src:e.videos[0]},on:{waiting:e.waiting,canplay:e.canPlay,click:e.pauseVideo,error:function(t){return t.preventDefault(),e.videoLoadError(t)}}})]),e._v(" "),r("transition",{attrs:{name:"fade"}},[r("v-overlay",{directives:[{name:"show",rawName:"v-show",value:!e.show&&!e.error||e.loading,expression:"(!show&&!error)||loading"}],attrs:{opacity:"0.1",value:!0,absolute:""}},[r("v-progress-circular",{attrs:{color:"pink",indeterminate:"",size:"64"}})],1)],1),e._v(" "),r("transition",{attrs:{name:"fade"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],staticClass:"load-error"},[r("v-card",{staticClass:"load-error d-flex align-center justify-center"},[r("v-chip",{attrs:{color:"pink",label:"",outlined:""}},[e._v("\n            视频加载失败请切换视频或者刷新浏览器！\n          ")])],1)],1)]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.iconPlayShow&&!e.error,expression:"iconPlayShow&&!error"}],staticClass:"icon-play",staticStyle:{left:"45%"}},[r("v-btn",{attrs:{fab:"",dark:"",large:"",color:"grey darken-3"},on:{click:e.pauseVideo}},[r("v-icon",[e._v("\n          mdi-play\n        ")])],1)],1),e._v(" "),r("div",{staticClass:"tool-btns"},[r("div",{staticClass:"d-flex flex-column"},[r("v-btn",{staticClass:"my-2",attrs:{fab:"",dark:"",color:"transparent",disabled:e.disableLike(e.videos[e.current])},on:{click:function(t){return e.like(e.videos[e.current])}}},[r("v-icon",{attrs:{color:"pink"}},[e._v("\n            mdi-heart\n          ")])],1),e._v(" "),r("v-btn",{staticClass:"my-2",attrs:{fab:"",dark:"",color:"transparent",disabled:e.disableDislike(e.videos[e.current])},on:{click:function(t){return e.dislike(e.videos[e.current])}}},[r("v-icon",{attrs:{color:"grey darken-4"}},[e._v("\n            mdi-thumb-down\n          ")])],1)],1)])]:[r("v-chip",{attrs:{color:"pink",label:"",outlined:""}},[e._v("\n      无法获取到视频源\n    ")])]],2)}),[],!1,null,"13d672c3",null);t.default=component.exports;d()(component,{VBtn:v.a,VCard:h.a,VChip:f.a,VIcon:w.a,VOverlay:m.a,VProgressCircular:y.a,VToolbar:k.a}),V()(component,{Touch:C.a})}}]);